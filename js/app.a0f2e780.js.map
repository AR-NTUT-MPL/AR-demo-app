{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/components/Layout.vue?d40f","webpack:///./src/App.vue?7b66","webpack:///./src/components/Main.vue?fe6f","webpack:///./src/components/KSpace.vue?b499","webpack:///./src/components/canvas.js","webpack:///./src/components/lib/throttle.js","webpack:///./src/components/lib/geo.js","webpack:///./src/components/lib/layout.js","webpack:///./src/components/lib/shape.js","webpack:///src/components/KSpace.vue","webpack:///./src/components/KSpace.vue?1b14","webpack:///./src/components/KSpace.vue","webpack:///./src/components/Layout.vue?ae45","webpack:///src/components/Layout.vue","webpack:///./src/components/Layout.vue?0d87","webpack:///./src/components/Layout.vue?4c7d","webpack:///src/components/Main.vue","webpack:///./src/components/Main.vue?e6c8","webpack:///./src/components/Main.vue","webpack:///src/App.vue","webpack:///./src/App.vue?60d0","webpack:///./src/App.vue?5a89","webpack:///./src/plugins/vuetify.js","webpack:///./src/main.js","webpack:///./src/App.vue?db16"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","_vm","this","_h","$createElement","_c","_self","attrs","_v","staticClass","staticRenderFns","model","props","callback","$$v","$set","_n","expression","scopedSlots","_u","fn","proxy","aspect","staticStyle","offset","g1","g3","k0","k1","k2","k3","material","on","$event","grating_period_update","g1_period","grating_angle_update","g1_angle","g2_period","g2_angle","g3_period","g3_angle","in_pos","in_size","in_shape1","in_shape2","out_pos","out_size","out_shape1","out_shape2","epe_shape","background_image","shape_types","update_background_image","_l","keys","prop","_s","isArray","item","directives","rawName","modifiers","domProps","target","composing","$forceUpdate","epe_shape_prop","ref","g1_props","g3_props","points","circle_props","canvas","alive","mounted","fabric","Canvas","$refs","addEventListener","resize_event","resize","destroyed","dispose","removeEventListener","methods","updatePolygon","polygon","_calcDimensions","width","height","left","top","nwidth","Math","max","abs","nheight","set","setCoords","throttle","delay","last_call","timer_id","last_output","throttled","ctx","args","arguments","now","Date","getTime","clearTimeout","setTimeout","single_promise","call_id","busy","single","Promise","done","then","finally","magsq","vec","v","mag","sqrt","tf","fov","offset_x","offset_y","aspect_x","aspect_y","diagonal","z","tan","dx","dy","rectangular","div","pow","sum","add","mul","diffraction","k","g","average_angle","angle","axis","x","y","extreme_angle","normalized_angle","sub","PI","mod","id_max","arraySync","id_min","kz","k_normz","extremum","values","trace_EPE","in_shape","in_displace","out_shape","out_displace","din","dout","d_in_pos","d_out_pos","dd","k2p","k3p","intersect","exk3","expandDims","exk2","k21","gather","k22","k31","k32","convhullshape","array","convshape","w","h","samples","fd","reverse","no","px","py","circular","a","shape2points","shape","scale","span_extreme_points","cross","b","convhull","sort","U","L","pop","concat","shape_tensor","index","shape1","shape2","A","B","reshape","Array","Number","mixins","k1_shape","k2_shape","k3_shape","circle1","circle2","k2_span_shape","k3_span_shape","create_k_patch","g1_update","g3_update","absolutePan","selection","setWidth","setHeight","calcOffset","fill","color","originX","originY","stroke","strokeWidth","lockRotation","lockScalingX","lockScalingY","hasControls","$emit","computed","k0_mat","scaling","requestRenderAll","component","style","backgroundImage","in_props","out_props","epe_props","String","in_patch1","in_patch2","out_patch1","out_patch2","epe_patch","create_coupling_patch","in_update","out_update","components","KSpace","Layout","wavelength","FOV","g0","in_shape_type","out_shape_type","isNaN","id","__ob__","dep","notify","cos","sin","update_epe","report","dataLayer","event","file","reader","onloadend","vm","console","log","filename","readAsDataURL","TIR","asin","g2","VCard","VCardText","VCardTitle","VCol","VContainer","VFileInput","VLabel","VRow","VSelect","VSlider","VTextField","Main","VApp","VDivider","VSpacer","Vue","use","Vuetify","config","productionTip","vuetify","render","App","$mount"],"mappings":"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","file":"js/app.a0f2e780.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Layout.vue?vue&type=style&index=0&id=b86eeaf8&lang=scss&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('v-app',[_c('header',[_c('v-container',[_c('v-row',[_c('v-col',{attrs:{\"cols\":\"12\",\"md\":\"8\"}},[_c('h1',[_vm._v(\" Compact design principle for diffractive exit-pupil expander in AR near-eye system \")]),_c('br'),_c('h3',[_vm._v(\"2021 SPIE. AR|VR|MR\")])]),_c('v-spacer'),_c('v-col',[_c('h2',{staticClass:\"lab-name\"},[_vm._v(\"Modern Nanophotonics Lab\")])])],1)],1)],1),_c('section',[_c('v-container',[_c('v-card',[_c('v-card-title',[_vm._v(\"Interactive Application\")]),_c('v-card-text',[_c('div',{staticClass:\"names\"},[_c('span',[_vm._v(\"Po-Han Chiu\"),_c('sup',[_vm._v(\"*a\")])]),_c('span',[_vm._v(\"Ting-Wei Huang\"),_c('sup',[_vm._v(\"a\")])]),_c('span',[_vm._v(\"Yun-Shou Hsu\"),_c('sup',[_vm._v(\"a\")])]),_c('span',[_vm._v(\"Bo-Kai Zhang\"),_c('sup',[_vm._v(\"a\")])]),_c('span',[_vm._v(\"Szu-Ta Chien\"),_c('sup',[_vm._v(\"a\")])]),_c('span',[_vm._v(\"Wen-Chang Hung\"),_c('sup',[_vm._v(\"b\")])]),_c('span',[_vm._v(\"Chien-Yi Huang\"),_c('sup',[_vm._v(\"b\")])]),_c('span',[_vm._v(\"Yu-Chieh Cheng\"),_c('sup',[_vm._v(\"a\")])])]),_c('div',[_c('p',[_c('sup',[_vm._v(\"a\")]),_vm._v(\"National Taipei University of Technology, No. 1, Section 3, Zhongxiao East Road, Da'an Dist., Taipei, 10608, Taiwan\"),_c('br'),_c('sup',[_vm._v(\"b\")]),_vm._v(\"ASUSTeK COMPUTER INC, No. 115, Li-De Rd., Beitou Dist., Taipei 112019, Taiwan \")])])]),_c('v-divider',{staticClass:\"mx-4\"}),_c('v-card-text',[_c('h3',[_vm._v(\"Abstract\")]),_c('p',[_vm._v(\" For a diffractive-waveguide-based augmented reality display, we demonstrate a rapid and straightforward method to define the most compact layout of an exit pupil expander (EPE) from an analysis of diffractive optical elements in k-space. The idea is to consider all k-vectors coming from in-coupling to out-coupling areas according to the grating theory, tracing out the EPE grating region, and with a geometrical modeling of this problem to find the optimal layout. For a working wavelength of 532 nm, 40 degrees field of view display, the solution to pack the entire layout into a enclosed circle radius and minimum area of EPE is presented. Furthermore, a web-based interactive application demonstrating the EPE layout calculation is provided as a layout design tool. \")]),_c('p',[_c('strong',[_vm._v(\"Keywords:\")]),_vm._v(\" Near-eye display, Waveguide, Augmented Reality, Exit-Pupil Expander, Diffractive Optical Elements. \")])])],1)],1)],1),_c('Main'),_c('footer',[_c('v-container',[_c('v-row',[_c('v-col',[_c('p',[_vm._v(\" Web Designer/Developer: Hans Chiu (Po-Han Chiu) \"),_c('br'),_vm._v(\" Email: t110658013@ntut.org.tw \")]),_c('p',[_vm._v(\"Developed with: Vue, Vuetify, Fabric, TensorFlow\")])]),_c('v-col',[_c('p',[_vm._v(\" This project is aimed to give readers a interactive way to understand the principle behind waveguide based AR glasses. \")]),_c('p',[_vm._v(\"Â© 2021 TaipeiTech\")])])],1)],1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('section',[_c('v-container',[_c('v-card',[_c('v-card-title',[_vm._v(\"Basic Settings\")]),_c('v-card-text',[_c('v-row',{staticClass:\"my-0\"},[_c('v-col',{staticClass:\"py-0\",attrs:{\"cols\":\"6\",\"md\":\"2\"}},[_c('v-text-field',{attrs:{\"label\":\"Wavelength\",\"suffix\":\"nm\"},model:{value:(_vm.props.wavelength),callback:function ($$v) {_vm.$set(_vm.props, \"wavelength\", _vm._n($$v))},expression:\"props.wavelength\"}})],1),_c('v-col',{staticClass:\"py-0\",attrs:{\"cols\":\"6\",\"md\":\"2\"}},[_c('v-text-field',{attrs:{\"label\":\"Refractive Index\"},model:{value:(_vm.props.material),callback:function ($$v) {_vm.$set(_vm.props, \"material\", _vm._n($$v))},expression:\"props.material\"}})],1),_c('v-col',{staticClass:\"py-0\",attrs:{\"cols\":\"12\",\"sm\":\"6\",\"md\":\"5\"}},[_c('v-slider',{attrs:{\"label\":\"FOV\",\"min\":\"0\",\"max\":\"150\",\"tick\":\"1\",\"thumb-label\":\"\"},scopedSlots:_vm._u([{key:\"append\",fn:function(){return [_c('v-text-field',{staticClass:\"mt-0 pt-0\",attrs:{\"dense\":\"\",\"suffix\":\"degrees\"},model:{value:(_vm.props.FOV),callback:function ($$v) {_vm.$set(_vm.props, \"FOV\", _vm._n($$v))},expression:\"props.FOV\"}})]},proxy:true}]),model:{value:(_vm.props.FOV),callback:function ($$v) {_vm.$set(_vm.props, \"FOV\", $$v)},expression:\"props.FOV\"}})],1),_c('v-col',{staticClass:\"py-0\",attrs:{\"cols\":\"12\",\"sm\":\"6\",\"md\":\"3\"}},[_c('v-row',[_c('v-col',[_c('v-text-field',{attrs:{\"label\":\"Aspect\"},model:{value:(_vm.props.aspect[0]),callback:function ($$v) {_vm.$set(_vm.props.aspect, 0, _vm._n($$v))},expression:\"props.aspect[0]\"}})],1),_c('v-col',[_c('v-text-field',{model:{value:(_vm.props.aspect[1]),callback:function ($$v) {_vm.$set(_vm.props.aspect, 1, _vm._n($$v))},expression:\"props.aspect[1]\"}})],1)],1)],1)],1),_c('v-row',{staticClass:\"my-n4\"},[_c('v-col',{staticClass:\"py-0\",attrs:{\"cols\":\"12\",\"sm\":\"6\"}},[_c('v-slider',{attrs:{\"label\":\"x offset\",\"dense\":\"\",\"min\":\"-1\",\"max\":\"1\",\"step\":\"0.1\",\"thumb-label\":\"\"},scopedSlots:_vm._u([{key:\"append\",fn:function(){return [_c('v-text-field',{staticClass:\"mt-0 pt-0\",staticStyle:{\"width\":\"60px\"},attrs:{\"dense\":\"\"},model:{value:(_vm.props.offset[0]),callback:function ($$v) {_vm.$set(_vm.props.offset, 0, _vm._n($$v))},expression:\"props.offset[0]\"}})]},proxy:true}]),model:{value:(_vm.props.offset[0]),callback:function ($$v) {_vm.$set(_vm.props.offset, 0, $$v)},expression:\"props.offset[0]\"}})],1),_c('v-col',{staticClass:\"py-0\",attrs:{\"cols\":\"12\",\"sm\":\"6\"}},[_c('v-slider',{attrs:{\"label\":\"y offset\",\"dense\":\"\",\"min\":\"-1\",\"max\":\"1\",\"step\":\"0.1\"},scopedSlots:_vm._u([{key:\"append\",fn:function(){return [_c('v-text-field',{staticClass:\"mt-0 pt-0\",staticStyle:{\"width\":\"60px\"},attrs:{\"dense\":\"\",\"thumb-label\":\"\"},model:{value:(_vm.props.offset[1]),callback:function ($$v) {_vm.$set(_vm.props.offset, 1, _vm._n($$v))},expression:\"props.offset[1]\"}})]},proxy:true}]),model:{value:(_vm.props.offset[1]),callback:function ($$v) {_vm.$set(_vm.props.offset, 1, $$v)},expression:\"props.offset[1]\"}})],1)],1)],1)],1)],1)],1),_c('section',[_c('v-container',[_c('v-row',[_c('v-col',{attrs:{\"sm\":\"6\"}},[_c('v-card',[_c('v-card-title',[_vm._v(\"K Space \")]),_c('v-card-text',[_c('p',[_vm._v(\"Drag to modify grating parameters.\")])]),_c('KSpace',{attrs:{\"g1\":_vm.props.g1,\"g3\":_vm.props.g3,\"k0\":_vm.k0,\"k1\":_vm.k1,\"k2\":_vm.k2,\"k3\":_vm.k3,\"material\":_vm.props.material},on:{\"update:g1\":function($event){return _vm.$set(_vm.props, \"g1\", $event)},\"update:g3\":function($event){return _vm.$set(_vm.props, \"g3\", $event)}}}),_c('v-card-text',[_c('div',[_c('v-row',[_c('v-col',{attrs:{\"cols\":\"2\"}}),_c('v-col',[_c('v-label',[_vm._v(\"Period\")])],1),_c('v-col',[_c('v-label',[_vm._v(\"Angle\")])],1)],1),_c('v-row',{staticClass:\"mt-n4\"},[_c('v-col',{staticClass:\"text-right mt-1\",attrs:{\"cols\":\"2\"}},[_c('v-label',[_vm._v(\" In \")])],1),_c('v-col',[_c('v-text-field',{staticClass:\"ma-0 pa-0\",attrs:{\"dense\":\"\"},on:{\"change\":function($event){return _vm.grating_period_update('g1', $event)}},model:{value:(_vm.g1_period),callback:function ($$v) {_vm.g1_period=_vm._n($$v)},expression:\"g1_period\"}})],1),_c('v-col',[_c('v-text-field',{staticClass:\"ma-0 pa-0\",attrs:{\"dense\":\"\"},on:{\"change\":function($event){return _vm.grating_angle_update('g1', $event)}},model:{value:(_vm.g1_angle),callback:function ($$v) {_vm.g1_angle=_vm._n($$v)},expression:\"g1_angle\"}})],1)],1),_c('v-row',{staticClass:\"mt-n8\"},[_c('v-col',{staticClass:\"text-right mt-1\",attrs:{\"cols\":\"2\"}},[_c('v-label',[_vm._v(\" EPE \")])],1),_c('v-col',[_c('v-text-field',{staticClass:\"ma-0 pa-0\",attrs:{\"dense\":\"\",\"readonly\":\"\"},model:{value:(_vm.g2_period),callback:function ($$v) {_vm.g2_period=_vm._n($$v)},expression:\"g2_period\"}})],1),_c('v-col',[_c('v-text-field',{staticClass:\"ma-0 pa-0\",attrs:{\"dense\":\"\",\"readonly\":\"\"},model:{value:(_vm.g2_angle),callback:function ($$v) {_vm.g2_angle=_vm._n($$v)},expression:\"g2_angle\"}})],1)],1),_c('v-row',{staticClass:\"mt-n8\"},[_c('v-col',{staticClass:\"text-right mt-1\",attrs:{\"cols\":\"2\"}},[_c('v-label',[_vm._v(\" Out \")])],1),_c('v-col',[_c('v-text-field',{staticClass:\"ma-0 pa-0\",attrs:{\"dense\":\"\"},on:{\"change\":function($event){return _vm.grating_period_update('g3', $event)}},model:{value:(_vm.g3_period),callback:function ($$v) {_vm.g3_period=_vm._n($$v)},expression:\"g3_period\"}})],1),_c('v-col',[_c('v-text-field',{staticClass:\"ma-0 pa-0\",attrs:{\"dense\":\"\"},on:{\"change\":function($event){return _vm.grating_angle_update('g3', $event)}},model:{value:(_vm.g3_angle),callback:function ($$v) {_vm.g3_angle=_vm._n($$v)},expression:\"g3_angle\"}})],1)],1)],1),_c('p',[_vm._v(\"Note: EPE parameters are automatically calculated.\")])])],1)],1),_c('v-col',{attrs:{\"sm\":\"6\"}},[_c('v-card',[_c('v-card-title',[_vm._v(\" Layout \")]),_c('v-card-text',[_c('p',[_vm._v(\"Drag to modify layout placement.\")])]),_c('Layout',{attrs:{\"in_pos\":_vm.props.in_pos,\"in_size\":_vm.props.in_size,\"in_shape1\":_vm.in_shape1,\"in_shape2\":_vm.in_shape2,\"out_pos\":_vm.props.out_pos,\"out_size\":_vm.props.out_size,\"out_shape1\":_vm.out_shape1,\"out_shape2\":_vm.out_shape2,\"epe_shape\":_vm.epe_shape,\"background_image\":_vm.background_image},on:{\"update:in_pos\":function($event){return _vm.$set(_vm.props, \"in_pos\", $event)},\"update:in_size\":function($event){return _vm.$set(_vm.props, \"in_size\", $event)},\"update:out_pos\":function($event){return _vm.$set(_vm.props, \"out_pos\", $event)},\"update:out_size\":function($event){return _vm.$set(_vm.props, \"out_size\", $event)}}}),_c('v-card-text',[_c('div',[_c('v-row',[_c('v-col',{attrs:{\"cols\":\"2\"}}),_c('v-col',[_c('v-label',[_vm._v(\"x\")])],1),_c('v-col',[_c('v-label',[_vm._v(\"y\")])],1),_c('v-col',[_c('v-label',[_vm._v(\"z\")])],1)],1),_c('v-row',{staticClass:\"mt-n4\"},[_c('v-col',{staticClass:\"text-right mt-1\",attrs:{\"cols\":\"2\"}},[_c('v-label',[_vm._v(\"In\")])],1),_c('v-col',[_c('v-text-field',{staticClass:\"ma-0 pa-0\",attrs:{\"dense\":\"\"},model:{value:(_vm.props.in_pos[0]),callback:function ($$v) {_vm.$set(_vm.props.in_pos, 0, _vm._n($$v))},expression:\"props.in_pos[0]\"}})],1),_c('v-col',[_c('v-text-field',{staticClass:\"ma-0 pa-0\",attrs:{\"dense\":\"\"},model:{value:(_vm.props.in_pos[1]),callback:function ($$v) {_vm.$set(_vm.props.in_pos, 1, _vm._n($$v))},expression:\"props.in_pos[1]\"}})],1),_c('v-col',[_c('v-text-field',{staticClass:\"ma-0 pa-0\",attrs:{\"dense\":\"\"},model:{value:(_vm.props.in_displace),callback:function ($$v) {_vm.$set(_vm.props, \"in_displace\", _vm._n($$v))},expression:\"props.in_displace\"}})],1)],1),_c('v-row',{staticClass:\"mt-n8\"},[_c('v-col',{staticClass:\"text-right mt-1\",attrs:{\"cols\":\"2\"}},[_c('v-label',[_vm._v(\"Out\")])],1),_c('v-col',[_c('v-text-field',{staticClass:\"ma-0 pa-0\",attrs:{\"dense\":\"\"},model:{value:(_vm.props.out_pos[0]),callback:function ($$v) {_vm.$set(_vm.props.out_pos, 0, _vm._n($$v))},expression:\"props.out_pos[0]\"}})],1),_c('v-col',[_c('v-text-field',{staticClass:\"ma-0 pa-0\",attrs:{\"dense\":\"\"},model:{value:(_vm.props.out_pos[1]),callback:function ($$v) {_vm.$set(_vm.props.out_pos, 1, _vm._n($$v))},expression:\"props.out_pos[1]\"}})],1),_c('v-col',[_c('v-text-field',{staticClass:\"ma-0 pa-0\",attrs:{\"dense\":\"\"},model:{value:(_vm.props.out_displace),callback:function ($$v) {_vm.$set(_vm.props, \"out_displace\", _vm._n($$v))},expression:\"props.out_displace\"}})],1)],1),_c('v-row',{staticClass:\"mt-n4\"},[_c('v-col',[_c('v-row',{staticClass:\"mt-n4\"},[_c('v-col',[_c('v-select',{attrs:{\"items\":_vm.shape_types,\"label\":\"In shape\",\"dense\":\"\"},model:{value:(_vm.props.in_shape_type),callback:function ($$v) {_vm.$set(_vm.props, \"in_shape_type\", $$v)},expression:\"props.in_shape_type\"}})],1)],1),_c('v-row',{staticClass:\"mt-n4\"},[_c('v-col',[_c('v-text-field',{staticClass:\"ma-0 pa-0\",attrs:{\"dense\":\"\",\"label\":\"width\"},model:{value:(_vm.props.in_size[0]),callback:function ($$v) {_vm.$set(_vm.props.in_size, 0, _vm._n($$v))},expression:\"props.in_size[0]\"}})],1),_c('v-col',[_c('v-text-field',{staticClass:\"ma-0 pa-0\",attrs:{\"dense\":\"\",\"label\":\"height\"},model:{value:(_vm.props.in_size[1]),callback:function ($$v) {_vm.$set(_vm.props.in_size, 1, _vm._n($$v))},expression:\"props.in_size[1]\"}})],1)],1)],1),_c('v-col',[_c('v-row',{staticClass:\"mt-n4\"},[_c('v-col',[_c('v-select',{attrs:{\"items\":_vm.shape_types,\"label\":\"Out shape\",\"dense\":\"\"},model:{value:(_vm.props.out_shape_type),callback:function ($$v) {_vm.$set(_vm.props, \"out_shape_type\", $$v)},expression:\"props.out_shape_type\"}})],1)],1),_c('v-row',{staticClass:\"mt-n4\"},[_c('v-col',[_c('v-text-field',{staticClass:\"ma-0 pa-0\",attrs:{\"dense\":\"\",\"label\":\"width\"},model:{value:(_vm.props.out_size[0]),callback:function ($$v) {_vm.$set(_vm.props.out_size, 0, _vm._n($$v))},expression:\"props.out_size[0]\"}})],1),_c('v-col',[_c('v-text-field',{staticClass:\"ma-0 pa-0\",attrs:{\"dense\":\"\",\"label\":\"height\"},model:{value:(_vm.props.out_size[1]),callback:function ($$v) {_vm.$set(_vm.props.out_size, 1, _vm._n($$v))},expression:\"props.out_size[1]\"}})],1)],1)],1)],1)],1)])],1)],1)],1)],1)],1),_c('section',[_c('v-container',[_c('v-card',[_c('v-card-title',[_vm._v(\" Customization \")]),_c('v-card-text',[_c('v-row',[_c('v-col',[_c('v-file-input',{attrs:{\"label\":\"Background Image\",\"dense\":\"\"},on:{\"change\":_vm.update_background_image}})],1)],1)],1)],1)],1)],1),_c('section',[_c('v-container',[_c('v-card',[_c('v-card-title',[_vm._v(\" Parameters \")]),_c('v-card-text',[_vm._l((Object.keys(_vm.props)),function(prop){return [_c('v-row',{key:prop,staticClass:\"mt-n4\"},[_c('v-col',{staticClass:\"text-right\",attrs:{\"cols\":\"4\",\"sm\":\"3\"}},[_c('label',{attrs:{\"for\":prop}},[_vm._v(_vm._s(prop)+\": \")])]),_c('v-col',[(_vm.isArray(_vm.props[prop]))?_vm._l((_vm.props[prop]),function(item,i){return _c('span',{key:i},[_c('input',{directives:[{name:\"model\",rawName:\"v-model.number\",value:(_vm.props[prop][i]),expression:\"props[prop][i]\",modifiers:{\"number\":true}}],attrs:{\"name\":prop,\"type\":\"text\"},domProps:{\"value\":(_vm.props[prop][i])},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.$set(_vm.props[prop], i, _vm._n($event.target.value))},\"blur\":function($event){return _vm.$forceUpdate()}}})])}):[_c('input',{directives:[{name:\"model\",rawName:\"v-model.number\",value:(_vm.props[prop]),expression:\"props[prop]\",modifiers:{\"number\":true}}],attrs:{\"name\":prop,\"type\":\"text\"},domProps:{\"value\":(_vm.props[prop])},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.$set(_vm.props, prop, _vm._n($event.target.value))},\"blur\":function($event){return _vm.$forceUpdate()}}})]],2)],1)]})],2)],1)],1)],1),_c('div',{attrs:{\"hidden\":\"\"}},[_vm._v(\" \"+_vm._s(_vm.epe_shape_prop)+\" \")])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{ref:\"base\"},[_c('canvas',{ref:\"canvas\",staticClass:\"canvas\",attrs:{\"width\":\"500\",\"height\":\"500\"}}),_c('div',{attrs:{\"hidden\":\"\"}},[_vm._v(\" \"+_vm._s(_vm.g1_props)+\" \"+_vm._s(_vm.g3_props)+\" \"+_vm._s(_vm.points)+\" \"+_vm._s(_vm.circle_props)+\" \")])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { fabric } from \"fabric\"\r\n\r\nexport default {\r\n    data() {\r\n        return {\r\n            // ctx: null,\r\n            canvas: null,\r\n            alive: false,\r\n        }\r\n    },\r\n    mounted() {\r\n        this.alive = true\r\n        this.canvas = new fabric.Canvas(this.$refs.canvas)\r\n        // this.ctx = this.canvas.getContext('2d')\r\n        window.addEventListener(\"resize\", this.resize_event)\r\n        this.resize()\r\n    },\r\n    destroyed() {\r\n        this.alive = false\r\n        this.canvas.dispose()\r\n        window.removeEventListener(\"resize\", this.resize_event)\r\n    },\r\n    methods: {\r\n        resize_event() {\r\n            this.resize()\r\n        },\r\n        resize() {\r\n            // console.log(\"resize from mixin\")\r\n        },\r\n\r\n        updatePolygon(polygon) {\r\n            const { width, height, left, top } = polygon._calcDimensions()\r\n            const nwidth = Math.max(Math.abs(left), Math.abs(left + width)) * 2\r\n            const nheight = Math.max(Math.abs(top), Math.abs(top + height)) * 2\r\n            polygon\r\n                .set({\r\n                    width: nwidth,\r\n                    height: nheight,\r\n                    // pathOffset: new fabric.Point(left + nwidth / 2, top + nheight / 2),\r\n                })\r\n                .setCoords()\r\n        },\r\n\r\n\r\n    },\r\n}","function throttle(callback, delay) {\r\n    let last_call = null\r\n    let timer_id = null\r\n    let last_output = null\r\n\r\n    function throttled() {\r\n        const ctx = this\r\n        const args = arguments\r\n        let now = new Date().getTime()\r\n\r\n        clearTimeout(timer_id)\r\n\r\n        if (!last_call || now - last_call > delay) {\r\n\r\n            last_output = callback.apply(ctx, args)\r\n            last_call = now\r\n\r\n        } else {\r\n            timer_id = setTimeout(() => {\r\n                last_output = callback.apply(ctx, args)\r\n                last_call = null\r\n            }, delay)\r\n        }\r\n        return last_output\r\n    }\r\n    return throttled\r\n}\r\n\r\n\r\nfunction single_promise(callback) {\r\n    let call_id = null\r\n    let busy = false\r\n    function single() {\r\n        const ctx = this\r\n        const args = arguments\r\n\r\n        clearTimeout(call_id)\r\n        \r\n        if (busy) {\r\n            call_id = setTimeout(() => {\r\n                single.apply(ctx, args)\r\n            }, 0)\r\n            return\r\n        }\r\n\r\n        busy = true\r\n\r\n        return new Promise(done => {\r\n            callback.apply(ctx, args).then(() => {\r\n                done(arguments)\r\n            }).finally(() => {\r\n                busy = false\r\n            })\r\n        })\r\n    }\r\n    return single\r\n}\r\n\r\n\r\nexport {\r\n    throttle, single_promise\r\n}","function magsq(vec){\r\n    let s = 0\r\n    for (let v of vec){\r\n        s+=v**2\r\n    }\r\n    return s\r\n}\r\n\r\nfunction mag(vec){\r\n    return Math.sqrt(magsq(vec))\r\n}\r\n\r\nexport {\r\n    magsq, mag\r\n}","import { mag } from './geo'\r\nimport { convshape, convhullshape, rectangular } from './shape'\r\nimport * as tf from '@tensorflow/tfjs'\r\n\r\ntf.setBackend('cpu')\r\n\r\nconst k1 = function (k0, fov, offset_x, offset_y, aspect_x, aspect_y) {\r\n    const diagonal = mag([aspect_x, aspect_y])\r\n    const z = diagonal / 2 / Math.tan(fov / 2)\r\n\r\n    const dx = aspect_x * 0.5 * offset_x\r\n    const dy = aspect_y * 0.5 * offset_y\r\n    const points = rectangular(+dx, +dy,\r\n        +aspect_x - Math.abs(dx) * 2,\r\n        +aspect_y - Math.abs(dy) * 2, 8)\r\n    tf.dispose([dx, dy])\r\n    return points.div(points.pow(2).sum(0).add(z ** 2).sqrt()).mul(k0)\r\n}\r\n\r\nconst diffraction = function (k, g) {\r\n    return tf.add(tf.tensor(k), tf.tensor([[g[0]], [g[1]]]))\r\n}\r\n\r\nconst average_angle = function (angle, axis = null) {\r\n    const x = tf.mean(tf.cos(angle), axis)\r\n    const y = tf.mean(tf.sin(angle), axis)\r\n    return tf.atan2(y, x)\r\n}\r\n\r\nconst extreme_angle = function (k) {\r\n    const angle = tf.atan2(k[0], k[1])\r\n    const normalized_angle = angle.sub(average_angle(angle)).add(Math.PI).mod(Math.PI * 2).sub(Math.PI)\r\n    const id_max = tf.argMax(normalized_angle).arraySync()\r\n    const id_min = tf.argMin(normalized_angle).arraySync()\r\n    tf.dispose([angle, normalized_angle])\r\n    return [id_max, id_min]\r\n}\r\n\r\n\r\nconst kz = function (k, k0) {\r\n    return tf.sqrt(tf.sub(k0 ** 2, tf.mul(k, k).sum(0)))\r\n}\r\n\r\nconst k_normz = function (k, k0) {\r\n    return tf.div(k, kz(k, k0))\r\n}\r\n\r\n\r\nfunction extremum(values, axis = null) {\r\n    return tf.concat([tf.max(values, axis, true), tf.min(values, axis, true)], axis)\r\n}\r\n\r\n\r\nconst trace_EPE = async function (in_pos, in_shape, in_displace, out_pos, out_shape, out_displace, k0, k1, k2, k3) {\r\n    const din = k_normz(k1, k0).mul(in_displace)\r\n    const dout = k_normz(k1, k0).mul(-out_displace)\r\n\r\n    const d_in_pos = tf.expandDims(in_pos, 1).add(din)\r\n    const d_out_pos = tf.expandDims(out_pos, 1).add(dout)\r\n\r\n    const dd = tf.sub(d_out_pos, d_in_pos)\r\n    const k2p = tf.mul([k2[1], k2[0]], [[-1], [1]])\r\n    const k3p = tf.mul([k3[1], k3[0]], [[-1], [1]])\r\n\r\n    const intersect = d_out_pos.sub(\r\n        tf.cast(k3, \"float32\")\r\n            .mul(tf.mul(dd, k2p).sum(0))\r\n            .div(tf.mul(k3, k2p).sum(0)))\r\n\r\n\r\n    const exk3 = extremum(tf.mul(tf.expandDims(in_shape, 1), tf.expandDims(k2p, 2)).sum(0), 1)\r\n        .mul(tf.mul(k2p, k3).sum(0)\r\n            .div(tf.mul(k2p, k2p).sum(0))\r\n            .div(tf.mul(k3, k3).sum(0)).expandDims(1))\r\n\r\n\r\n    const exk2 = extremum(tf.mul(tf.expandDims(out_shape, 1), tf.expandDims(k3p, 2)).sum(0), 1)\r\n        .mul(tf.mul(k3p, k2).sum(0)\r\n            .div(tf.mul(k3p, k3p).sum(0))\r\n            .div(tf.mul(k2, k2).sum(0)).expandDims(1))\r\n\r\n    tf.dispose(\r\n        dd, k2p, k3p, intersect\r\n    )\r\n\r\n    const k21 = tf.mul(exk2.gather(0, 1), k2)\r\n    const k22 = tf.mul(exk2.gather(1, 1), k2)\r\n    const k31 = tf.mul(exk3.gather(0, 1), k3)\r\n    const k32 = tf.mul(exk3.gather(1, 1), k3)\r\n\r\n    const epe_shape = await convhullshape(tf.concat([\r\n        intersect.add(k21).add(k31),\r\n        intersect.add(k22).add(k31),\r\n        intersect.add(k21).add(k32),\r\n        intersect.add(k22).add(k32),\r\n    ], 1)).array()\r\n\r\n    const in_shape2 = await convshape(din, in_shape).array()\r\n    const out_shape2 = await convshape(dout, out_shape).array()\r\n\r\n\r\n    tf.dispose(\r\n        exk2, exk3, k21, k22, k31, k32\r\n    )\r\n\r\n    return [in_shape2, epe_shape, out_shape2]\r\n}\r\n\r\n\r\n\r\nexport {\r\n    k1, diffraction, extreme_angle, kz, k_normz, trace_EPE,\r\n}\r\n","import * as tf from \"@tensorflow/tfjs\"\r\nimport { extreme_angle } from \"./layout\"\r\n\r\nfunction rectangular(x, y, w, h, samples) {\r\n  let d = tf.range(0, samples + 1).div(samples).sub(0.5)\r\n  let fd = d.reverse()\r\n\r\n  d = d.slice(0, samples)\r\n  fd = fd.slice(0, samples)\r\n\r\n  let o = tf.ones([samples]).mul(0.5)\r\n  let no = o.mul(-1)\r\n  let px = tf.concat1d([d, o, fd, no]).mul(w).add(x)\r\n  let py = tf.concat1d([no, d, o, fd]).mul(h).add(y)\r\n  return tf.concat2d([px.expandDims(0), py.expandDims(0)])\r\n}\r\n\r\nfunction circular(x, y, w, h, samples) {\r\n  let a = tf.range(0, samples).div(samples).mul(Math.PI * 2)\r\n  let px = tf.cos(a).mul(w / 2).add(x)\r\n  let py = tf.sin(a).mul(h / 2).add(y)\r\n  return tf.concat2d([px.expandDims(0), py.expandDims(0)])\r\n}\r\n\r\n\r\nfunction shape2points(shape, scale) {\r\n  let points = []\r\n  for (let i = 0; i < shape[0].length; i++) {\r\n    points.push({\r\n      x: shape[0][i] * scale,\r\n      y: -shape[1][i] * scale,\r\n    })\r\n  }\r\n  return points\r\n}\r\n\r\n\r\nfunction span_extreme_points(k, scale) {\r\n  let [id_max, id_min] = extreme_angle(k)\r\n  return [\r\n    { x: 0, y: 0 },\r\n    {\r\n      x: k[0][id_max] * scale,\r\n      y: -k[1][id_max] * scale,\r\n    },\r\n    {\r\n      x: k[0][id_min] * scale,\r\n      y: -k[1][id_min] * scale,\r\n    },\r\n  ]\r\n}\r\n\r\n\r\nfunction cross(o, a, b) {\r\n  return (a[0] - o[0]) * (b[1] - o[1]) - (a[1] - o[1]) * (b[0] - o[0])\r\n}\r\n\r\nfunction convhull(shape) {\r\n  let p = []\r\n  for (let i = 0; i < shape[0].length; i++) p.push(i)\r\n\r\n  p.sort((a, b) => {\r\n    if (shape[0][a] < shape[0][b]) return -1\r\n    if (shape[0][a] > shape[0][b]) return 1\r\n    return shape[1][a] - shape[1][b]\r\n  })\r\n\r\n  let U = []\r\n  let L = []\r\n\r\n  for (let i of p) {\r\n    while (L.length >= 2 && cross(\r\n      [shape[0][L[L.length - 2]], shape[1][L[L.length - 2]]],\r\n      [shape[0][L[L.length - 1]], shape[1][L[L.length - 1]]],\r\n      [shape[0][i], shape[1][i]],\r\n    ) <= 0) L.pop()\r\n    while (L.length >= 2 && cross(\r\n      [shape[0][U[U.length - 2]], shape[1][U[U.length - 2]]],\r\n      [shape[0][U[U.length - 1]], shape[1][U[U.length - 1]]],\r\n      [shape[0][i], shape[1][i]],\r\n    ) >= 0) U.pop()\r\n    L.push(i)\r\n    U.push(i)\r\n  }\r\n\r\n  return L.concat(U.slice(1, -1).reverse())\r\n}\r\n\r\nfunction convhullshape(shape) {\r\n  let shape_tensor = tf.cast(shape, 'float32')\r\n  shape = shape_tensor.arraySync()\r\n  let index = convhull(shape)\r\n  return shape_tensor.gather(index, 1)\r\n}\r\n\r\nconst convshape = function (shape1, shape2) {\r\n  let A = tf.expandDims(shape1, 1)\r\n  let B = tf.expandDims(shape2, 2)\r\n  return convhullshape(A.add(B).reshape([2, -1]))\r\n}\r\n\r\n\r\nexport {\r\n  rectangular, circular,\r\n  shape2points, span_extreme_points,\r\n  convhull, convhullshape, convshape\r\n}","<template>\r\n  <div ref=\"base\">\r\n    <canvas class=\"canvas\" width=\"500\" height=\"500\" ref=\"canvas\"> </canvas>\r\n    <div hidden>\r\n      {{ g1_props }}\r\n      {{ g3_props }}\r\n      {{ points }}\r\n      {{ circle_props }}\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport canvas from \"./canvas.js\";\r\nimport { fabric } from \"fabric\";\r\nimport { throttle } from \"./lib/throttle.js\";\r\nimport { shape2points, span_extreme_points } from \"./lib/shape.js\";\r\n\r\nexport default {\r\n  props: {\r\n    g1: Array,\r\n    g3: Array,\r\n    k0: Number,\r\n    k1: Array,\r\n    k2: Array,\r\n    k3: Array,\r\n    material: Number,\r\n  },\r\n\r\n  mixins: [canvas],\r\n\r\n  data() {\r\n    return {\r\n      // typings\r\n      /**@type {fabric.Canvas} */\r\n      canvas: null,\r\n      // shapes\r\n      k1_shape: null,\r\n      k2_shape: null,\r\n      k3_shape: null,\r\n      circle1: null,\r\n      circle2: null,\r\n      k2_span_shape: null,\r\n      k3_span_shape: null,\r\n    };\r\n  },\r\n\r\n  // SETUP -------------------------------------\r\n  mounted() {\r\n    this.canvas.add(\r\n      (this.k1_shape = new fabric.Polygon([], {\r\n        fill: \"#37474f\",\r\n        left: 0,\r\n        top: 0,\r\n        originX: \"center\",\r\n        originY: \"center\",\r\n        evented: false,\r\n      }))\r\n    );\r\n\r\n    this.canvas.add(\r\n      (this.k2_span_shape = new fabric.Polygon([], {\r\n        fill: \"#ffcc8080\",\r\n        left: 0,\r\n        top: 0,\r\n        originX: \"center\",\r\n        originY: \"center\",\r\n        evented: false,\r\n      }))\r\n    );\r\n\r\n    this.canvas.add(\r\n      (this.k3_span_shape = new fabric.Polygon([], {\r\n        fill: \"#90caf980\",\r\n        left: 0,\r\n        top: 0,\r\n        originX: \"center\",\r\n        originY: \"center\",\r\n        evented: false,\r\n      }))\r\n    );\r\n\r\n    this.canvas.add(\r\n      (this.circle1 = new fabric.Circle({\r\n        stroke: \"black\",\r\n        fill: null,\r\n        strokeWidth: 2,\r\n        radius: 1000,\r\n        selectable: false,\r\n        originX: \"center\",\r\n        originY: \"center\",\r\n        evented: false,\r\n      }))\r\n    );\r\n\r\n    this.canvas.add(\r\n      (this.circle2 = new fabric.Circle({\r\n        stroke: \"black\",\r\n        fill: null,\r\n        strokeWidth: 2,\r\n        radius: 1000,\r\n        selectable: false,\r\n        originX: \"center\",\r\n        originY: \"center\",\r\n        evented: false,\r\n      }))\r\n    );\r\n\r\n    this.canvas.set(\"scaleY\", -1);\r\n\r\n    this.k2_shape = this.create_k_patch(\"#ff9800\", this.g1_update);\r\n    this.k3_shape = this.create_k_patch(\"#2196f3\", this.g3_update);\r\n\r\n    this.canvas.absolutePan(\r\n      new fabric.Point(-this.canvas.width / 2, -this.canvas.height / 2)\r\n    );\r\n    this.canvas.selection = false;\r\n  },\r\n  methods: {\r\n    resize() {\r\n      let s = this.$refs.base.getBoundingClientRect().width;\r\n      // s = Math.min(s, 500);\r\n      this.canvas.setWidth(s);\r\n      this.canvas.setHeight(s);\r\n      this.canvas.calcOffset();\r\n      this.canvas.absolutePan(\r\n        new fabric.Point(-this.canvas.width / 2, -this.canvas.height / 2)\r\n      );\r\n    },\r\n\r\n    create_k_patch(color, callback) {\r\n      let shape = new fabric.Polygon([], {\r\n        fill: color,\r\n        originX: \"center\",\r\n        originY: \"center\",\r\n        stroke: \"white\",\r\n        strokeWidth: 2,\r\n        lockRotation: true,\r\n        lockScalingX: true,\r\n        lockScalingY: true,\r\n        hasControls: false,\r\n        // width: 100,\r\n        // height: 100,\r\n      })\r\n        .on(\"modified\", callback)\r\n        .on(\"moving\", callback);\r\n      this.canvas.add(shape);\r\n\r\n      return shape;\r\n    },\r\n    // update events\r\n    g1_update: throttle(function () {\r\n      this.$emit(\"update:g1\", [\r\n        this.k2_shape.get(\"left\") / this.scaling,\r\n        -this.k2_shape.get(\"top\") / this.scaling,\r\n      ]);\r\n    }, 20),\r\n    g3_update: throttle(function () {\r\n      this.$emit(\"update:g3\", [\r\n        -this.k3_shape.get(\"left\") / this.scaling,\r\n        this.k3_shape.get(\"top\") / this.scaling,\r\n      ]);\r\n    }, 20),\r\n  },\r\n  computed: {\r\n    k0_mat() {\r\n      return this.k0 * this.material;\r\n    },\r\n    scaling() {\r\n      return (this.canvas.width / 2 / this.k0_mat) * 0.8;\r\n    },\r\n\r\n    // K vector fields\r\n    g1_props() {\r\n      if (!this.k2_shape) return 0;\r\n      this.k2_shape.set(\"left\", this.g1[0] * this.scaling);\r\n      this.k2_shape.set(\"top\", -this.g1[1] * this.scaling);\r\n      this.k2_shape.setCoords();\r\n      this.k2_span_shape.set(\r\n        \"points\",\r\n        span_extreme_points(this.k2, this.scaling)\r\n      );\r\n      this.updatePolygon(this.k2_span_shape);\r\n      this.canvas.requestRenderAll();\r\n      return 0;\r\n    },\r\n\r\n    g3_props() {\r\n      if (!this.k3_shape) return 0;\r\n      this.k3_shape.set(\"left\", -this.g3[0] * this.scaling);\r\n      this.k3_shape.set(\"top\", this.g3[1] * this.scaling);\r\n      this.k3_shape.setCoords();\r\n      this.k3_span_shape.set(\r\n        \"points\",\r\n        span_extreme_points(this.k3, this.scaling)\r\n      );\r\n      this.updatePolygon(this.k3_span_shape);\r\n      this.canvas.requestRenderAll();\r\n      return 0;\r\n    },\r\n\r\n    points() {\r\n      if (!this.k1_shape) return 0;\r\n      let points = shape2points(this.k1, this.scaling);\r\n      this.k1_shape.set(\"points\", points);\r\n      this.k2_shape.set(\"points\", points);\r\n      this.k3_shape.set(\"points\", points);\r\n      this.updatePolygon(this.k1_shape);\r\n      this.updatePolygon(this.k2_shape);\r\n      this.updatePolygon(this.k3_shape);\r\n\r\n      this.canvas.requestRenderAll();\r\n      return 0;\r\n    },\r\n\r\n    // donuts\r\n    circle_props() {\r\n      if (!this.circle1) return 0;\r\n      this.circle1.set(\"radius\", this.k0 * this.scaling);\r\n      this.circle2.set(\"radius\", this.k0_mat * this.scaling);\r\n      this.circle1.setCoords();\r\n      this.circle2.setCoords();\r\n      this.canvas.requestRenderAll();\r\n      return 0;\r\n    },\r\n  },\r\n};\r\n</script>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./KSpace.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./KSpace.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./KSpace.vue?vue&type=template&id=5f5d1fe2&\"\nimport script from \"./KSpace.vue?vue&type=script&lang=js&\"\nexport * from \"./KSpace.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{ref:\"base\"},[_c('div',{staticClass:\"layout-container\"},[_c('div',{staticClass:\"layout-canvas-bg\",style:({ backgroundImage: 'url(' + _vm.background_image + ')' })}),_c('div',[_c('canvas',{ref:\"canvas\",staticClass:\"canvas\",attrs:{\"width\":\"500\",\"height\":\"500\"}})])]),_c('div',{attrs:{\"hidden\":\"\"}},[_vm._v(\" \"+_vm._s(_vm.in_props)+\" \"+_vm._s(_vm.out_props)+\" \"+_vm._s(_vm.epe_props)+\" \")])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div ref=\"base\">\r\n    <div class=\"layout-container\">\r\n      <div\r\n        class=\"layout-canvas-bg\"\r\n        :style=\"{ backgroundImage: 'url(' + background_image + ')' }\"\r\n      ></div>\r\n\r\n      <div>\r\n        <canvas class=\"canvas\" width=\"500\" height=\"500\" ref=\"canvas\"> </canvas>\r\n      </div>\r\n    </div>\r\n\r\n    <div hidden>\r\n      {{ in_props }}\r\n      {{ out_props }}\r\n      {{ epe_props }}\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport canvas from \"./canvas.js\";\r\nimport { fabric } from \"fabric\";\r\nimport { throttle } from \"./lib/throttle.js\";\r\nimport { shape2points } from \"./lib/shape.js\";\r\n\r\nexport default {\r\n  props: {\r\n    in_pos: Array,\r\n    in_size: Array,\r\n    in_shape1: Array,\r\n    in_shape2: Array,\r\n    out_pos: Array,\r\n    out_size: Array,\r\n    out_shape1: Array,\r\n    out_shape2: Array,\r\n    epe_shape: Array,\r\n    background_image: String,\r\n  },\r\n\r\n  mixins: [canvas],\r\n\r\n  data() {\r\n    return {\r\n      // typings\r\n      /**@type {fabric.Canvas} */\r\n      canvas: null,\r\n      // shapes\r\n      in_patch1: null,\r\n      in_patch2: null,\r\n      out_patch1: null,\r\n      out_patch2: null,\r\n      epe_patch: null,\r\n    };\r\n  },\r\n\r\n  // SETUP -------------------------------------\r\n  mounted() {\r\n    this.canvas.selection = false;\r\n\r\n    this.canvas.add(\r\n      (this.in_patch2 = new fabric.Polygon([], {\r\n        fill: \"#37474f80\",\r\n        originX: \"center\",\r\n        originY: \"center\",\r\n        evented: false,\r\n      }))\r\n    );\r\n\r\n    this.canvas.add(\r\n      (this.out_patch2 = new fabric.Polygon([], {\r\n        fill: \"#2196f380\",\r\n        originX: \"center\",\r\n        originY: \"center\",\r\n        evented: false,\r\n      }))\r\n    );\r\n\r\n    this.canvas.add(\r\n      (this.epe_patch = new fabric.Polygon([], {\r\n        fill: \"#ff980080\",\r\n        originX: \"center\",\r\n        originY: \"center\",\r\n        evented: false,\r\n      }))\r\n    );\r\n\r\n    this.in_patch1 = this.create_coupling_patch(\"#37474f\", this.in_update);\r\n\r\n    this.out_patch1 = this.create_coupling_patch(\"#2196f3\", this.out_update);\r\n  },\r\n\r\n  methods: {\r\n    resize() {\r\n      let s = this.$refs.base.getBoundingClientRect().width;\r\n      // s = Math.min(s, 500);\r\n      this.canvas.setWidth(s);\r\n      this.canvas.setHeight(s);\r\n      this.canvas.calcOffset();\r\n      this.canvas.absolutePan(\r\n        new fabric.Point(-this.canvas.width / 2, -this.canvas.height / 2)\r\n      );\r\n    },\r\n\r\n    create_coupling_patch(color, callback) {\r\n      let shape = new fabric.Polygon([], {\r\n        fill: color,\r\n        originX: \"center\",\r\n        originY: \"center\",\r\n        lockRotation: true,\r\n        // lockScalingX: true,\r\n        // lockScalingY: true,\r\n        // hasControls: false,\r\n        width: 100,\r\n        height: 100,\r\n      })\r\n        .on(\"modified\", callback)\r\n        .on(\"moving\", callback);\r\n      this.canvas.add(shape);\r\n\r\n      return shape;\r\n    },\r\n\r\n    // update events\r\n    in_update: throttle(function () {\r\n      this.$emit(\"update:in_pos\", [\r\n        this.in_patch1.get(\"left\") / this.scaling,\r\n        -this.in_patch1.get(\"top\") / this.scaling,\r\n      ]);\r\n      this.$emit(\"update:in_size\", [\r\n        this.in_patch1.get(\"scaleX\") * this.in_size[0],\r\n        this.in_patch1.get(\"scaleY\") * this.in_size[1],\r\n      ]);\r\n      this.in_patch1.set(\"scaleX\", 1);\r\n      this.in_patch1.set(\"scaleY\", 1);\r\n    }, 20),\r\n\r\n    out_update: throttle(function () {\r\n      this.$emit(\"update:out_pos\", [\r\n        this.out_patch1.get(\"left\") / this.scaling,\r\n        -this.out_patch1.get(\"top\") / this.scaling,\r\n      ]);\r\n      this.$emit(\"update:out_size\", [\r\n        this.out_patch1.get(\"scaleX\") * this.out_size[0],\r\n        this.out_patch1.get(\"scaleY\") * this.out_size[1],\r\n      ]);\r\n      this.out_patch1.set(\"scaleX\", 1);\r\n      this.out_patch1.set(\"scaleY\", 1);\r\n    }, 20),\r\n  },\r\n  computed: {\r\n    scaling() {\r\n      return this.canvas.width / 80;\r\n    },\r\n\r\n    in_props() {\r\n      if (!this.in_patch1) return 0;\r\n      this.in_patch1.set(\"left\", this.in_pos[0] * this.scaling);\r\n      this.in_patch1.set(\"top\", -this.in_pos[1] * this.scaling);\r\n      this.in_patch1.setCoords();\r\n      this.in_patch1.set(\"points\", shape2points(this.in_shape1, this.scaling));\r\n      this.updatePolygon(this.in_patch1);\r\n\r\n      this.in_patch2.set(\"left\", this.in_pos[0] * this.scaling);\r\n      this.in_patch2.set(\"top\", -this.in_pos[1] * this.scaling);\r\n      this.in_patch2.setCoords();\r\n      this.in_patch2.set(\"points\", shape2points(this.in_shape2, this.scaling));\r\n      this.updatePolygon(this.in_patch2);\r\n\r\n      this.canvas.requestRenderAll();\r\n      return 0;\r\n    },\r\n\r\n    out_props() {\r\n      if (!this.out_patch1) return 0;\r\n      this.out_patch1.set(\"left\", this.out_pos[0] * this.scaling);\r\n      this.out_patch1.set(\"top\", -this.out_pos[1] * this.scaling);\r\n      this.out_patch1.setCoords();\r\n      this.out_patch1.set(\r\n        \"points\",\r\n        shape2points(this.out_shape1, this.scaling)\r\n      );\r\n      this.updatePolygon(this.out_patch1);\r\n\r\n      this.out_patch2.set(\"left\", this.out_pos[0] * this.scaling);\r\n      this.out_patch2.set(\"top\", -this.out_pos[1] * this.scaling);\r\n      this.out_patch2.setCoords();\r\n      this.out_patch2.set(\r\n        \"points\",\r\n        shape2points(this.out_shape2, this.scaling)\r\n      );\r\n      this.updatePolygon(this.out_patch2);\r\n\r\n      this.canvas.requestRenderAll();\r\n      return 0;\r\n    },\r\n\r\n    epe_props() {\r\n      if (!this.out_patch1) return 0;\r\n      this.epe_patch.set(\"points\", shape2points(this.epe_shape, this.scaling));\r\n      this.updatePolygon(this.epe_patch);\r\n      this.canvas.requestRenderAll();\r\n      return 0;\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.layout-container {\r\n  position: relative;\r\n  width: 100%;\r\n}\r\n.layout-canvas-bg {\r\n  position: absolute;\r\n  background-size: contain;\r\n  background-position: center;\r\n  width: 100%;\r\n  height: 100%;\r\n  left: 0;\r\n  top: 0;\r\n  opacity: 0.3;\r\n  pointer-events: none;\r\n}\r\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Layout.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Layout.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Layout.vue?vue&type=template&id=b86eeaf8&scoped=true&\"\nimport script from \"./Layout.vue?vue&type=script&lang=js&\"\nexport * from \"./Layout.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Layout.vue?vue&type=style&index=0&id=b86eeaf8&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"b86eeaf8\",\n  null\n  \n)\n\nexport default component.exports","<template>\r\n  <div>\r\n    <!-- <section>\r\n      <v-container>\r\n        <h3>Presets</h3>\r\n        <v-btn> 0-45-90 </v-btn>\r\n        <v-btn> 60-60-60 </v-btn>\r\n      </v-container>\r\n    </section> -->\r\n    <section>\r\n      <v-container>\r\n        <v-card>\r\n          <v-card-title>Basic Settings</v-card-title>\r\n          <v-card-text>\r\n            <!-- <p>\r\n              Use the settings bellow to configure the AR device, the working\r\n              wavelength is {{ props.wavelength }} nano meters. Due to the\r\n              refractive index of {{ props.material }} of the waveguide, the\r\n              critical angle of total internal reflection is calculated to be\r\n              {{ TIR }} radians, and is denoted by the inner circle of the\r\n              K-Space figure. The diagonal field of view (FOV) is\r\n              {{ props.FOV }} degrees, with screen aspect ratio of\r\n              {{ props.aspect[0] }} : {{ props.aspect[1] }}. Therfore, the\r\n              incident k-vectors are know and is denoted by the gray area in the\r\n              center of the k-space figure.\r\n            </p> -->\r\n            <v-row class=\"my-0\">\r\n              <v-col cols=\"6\" md=\"2\" class=\"py-0\">\r\n                <v-text-field\r\n                  label=\"Wavelength\"\r\n                  suffix=\"nm\"\r\n                  v-model.number=\"props.wavelength\"\r\n                ></v-text-field>\r\n              </v-col>\r\n              <v-col cols=\"6\" md=\"2\" class=\"py-0\">\r\n                <v-text-field\r\n                  label=\"Refractive Index\"\r\n                  v-model.number=\"props.material\"\r\n                ></v-text-field>\r\n              </v-col>\r\n              <v-col cols=\"12\" sm=\"6\" md=\"5\" class=\"py-0\">\r\n                <v-slider\r\n                  label=\"FOV\"\r\n                  v-model=\"props.FOV\"\r\n                  min=\"0\"\r\n                  max=\"150\"\r\n                  tick=\"1\"\r\n                  thumb-label\r\n                >\r\n                  <template v-slot:append>\r\n                    <v-text-field\r\n                      dense\r\n                      v-model.number=\"props.FOV\"\r\n                      class=\"mt-0 pt-0\"\r\n                      suffix=\"degrees\"\r\n                    ></v-text-field>\r\n                  </template>\r\n                </v-slider>\r\n              </v-col>\r\n              <v-col cols=\"12\" sm=\"6\" md=\"3\" class=\"py-0\">\r\n                <v-row>\r\n                  <v-col>\r\n                    <v-text-field\r\n                      label=\"Aspect\"\r\n                      v-model.number=\"props.aspect[0]\"\r\n                    ></v-text-field>\r\n                  </v-col>\r\n                  <v-col>\r\n                    <v-text-field\r\n                      v-model.number=\"props.aspect[1]\"\r\n                    ></v-text-field>\r\n                  </v-col>\r\n                </v-row>\r\n              </v-col>\r\n            </v-row>\r\n            <v-row class=\"my-n4\">\r\n              <v-col cols=\"12\" sm=\"6\" class=\"py-0\">\r\n                <v-slider\r\n                  label=\"x offset\"\r\n                  dense\r\n                  v-model=\"props.offset[0]\"\r\n                  min=\"-1\"\r\n                  max=\"1\"\r\n                  step=\"0.1\"\r\n                  thumb-label\r\n                >\r\n                  <template v-slot:append>\r\n                    <v-text-field\r\n                      dense\r\n                      v-model.number=\"props.offset[0]\"\r\n                      class=\"mt-0 pt-0\"\r\n                      style=\"width: 60px\"\r\n                    ></v-text-field>\r\n                  </template>\r\n                </v-slider>\r\n              </v-col>\r\n              <v-col cols=\"12\" sm=\"6\" class=\"py-0\">\r\n                <v-slider\r\n                  label=\"y offset\"\r\n                  dense\r\n                  v-model=\"props.offset[1]\"\r\n                  min=\"-1\"\r\n                  max=\"1\"\r\n                  step=\"0.1\"\r\n                >\r\n                  <template v-slot:append>\r\n                    <v-text-field\r\n                      dense\r\n                      v-model.number=\"props.offset[1]\"\r\n                      class=\"mt-0 pt-0\"\r\n                      thumb-label\r\n                      style=\"width: 60px\"\r\n                    ></v-text-field>\r\n                  </template>\r\n                </v-slider>\r\n              </v-col>\r\n            </v-row>\r\n          </v-card-text>\r\n        </v-card>\r\n      </v-container>\r\n    </section>\r\n    <section>\r\n      <v-container>\r\n        <v-row>\r\n          <v-col sm=\"6\">\r\n            <v-card>\r\n              <v-card-title>K Space </v-card-title>\r\n              <v-card-text>\r\n                <p>Drag to modify grating parameters.</p>\r\n              </v-card-text>\r\n              <KSpace\r\n                :g1.sync=\"props.g1\"\r\n                :g3.sync=\"props.g3\"\r\n                :k0=\"k0\"\r\n                :k1=\"k1\"\r\n                :k2=\"k2\"\r\n                :k3=\"k3\"\r\n                :material=\"props.material\"\r\n              ></KSpace>\r\n\r\n              <v-card-text>\r\n                <div>\r\n                  <v-row>\r\n                    <v-col cols=\"2\"></v-col>\r\n                    <v-col><v-label>Period</v-label></v-col>\r\n                    <v-col><v-label>Angle</v-label></v-col>\r\n                  </v-row>\r\n\r\n                  <v-row class=\"mt-n4\">\r\n                    <v-col cols=\"2\" class=\"text-right mt-1\">\r\n                      <v-label> In </v-label>\r\n                    </v-col>\r\n                    <v-col>\r\n                      <v-text-field\r\n                        dense\r\n                        v-model.number=\"g1_period\"\r\n                        class=\"ma-0 pa-0\"\r\n                        @change=\"grating_period_update('g1', $event)\"\r\n                      ></v-text-field>\r\n                    </v-col>\r\n                    <v-col>\r\n                      <v-text-field\r\n                        dense\r\n                        v-model.number=\"g1_angle\"\r\n                        class=\"ma-0 pa-0\"\r\n                        @change=\"grating_angle_update('g1', $event)\"\r\n                      ></v-text-field>\r\n                    </v-col>\r\n                  </v-row>\r\n\r\n                  <v-row class=\"mt-n8\">\r\n                    <v-col cols=\"2\" class=\"text-right mt-1\">\r\n                      <v-label> EPE </v-label>\r\n                    </v-col>\r\n\r\n                    <v-col>\r\n                      <v-text-field\r\n                        dense\r\n                        v-model.number=\"g2_period\"\r\n                        class=\"ma-0 pa-0\"\r\n                        readonly\r\n                      ></v-text-field>\r\n                    </v-col>\r\n                    <v-col>\r\n                      <v-text-field\r\n                        dense\r\n                        v-model.number=\"g2_angle\"\r\n                        class=\"ma-0 pa-0\"\r\n                        readonly\r\n                      ></v-text-field>\r\n                    </v-col>\r\n                  </v-row>\r\n\r\n                  <v-row class=\"mt-n8\">\r\n                    <v-col cols=\"2\" class=\"text-right mt-1\">\r\n                      <v-label> Out </v-label>\r\n                    </v-col>\r\n\r\n                    <v-col>\r\n                      <v-text-field\r\n                        dense\r\n                        v-model.number=\"g3_period\"\r\n                        class=\"ma-0 pa-0\"\r\n                        @change=\"grating_period_update('g3', $event)\"\r\n                      ></v-text-field>\r\n                    </v-col>\r\n                    <v-col>\r\n                      <v-text-field\r\n                        dense\r\n                        v-model.number=\"g3_angle\"\r\n                        class=\"ma-0 pa-0\"\r\n                        @change=\"grating_angle_update('g3', $event)\"\r\n                      ></v-text-field>\r\n                    </v-col>\r\n                  </v-row>\r\n                </div>\r\n                <p>Note: EPE parameters are automatically calculated.</p>\r\n              </v-card-text>\r\n            </v-card>\r\n          </v-col>\r\n          <v-col sm=\"6\">\r\n            <v-card>\r\n              <v-card-title> Layout </v-card-title>\r\n              <v-card-text>\r\n                <p>Drag to modify layout placement.</p>\r\n              </v-card-text>\r\n              <Layout\r\n                :in_pos.sync=\"props.in_pos\"\r\n                :in_size.sync=\"props.in_size\"\r\n                :in_shape1=\"in_shape1\"\r\n                :in_shape2=\"in_shape2\"\r\n                :out_pos.sync=\"props.out_pos\"\r\n                :out_size.sync=\"props.out_size\"\r\n                :out_shape1=\"out_shape1\"\r\n                :out_shape2=\"out_shape2\"\r\n                :epe_shape=\"epe_shape\"\r\n                :background_image=\"background_image\"\r\n              ></Layout>\r\n              <v-card-text>\r\n                <div>\r\n                  <v-row>\r\n                    <v-col cols=\"2\"></v-col>\r\n                    <v-col><v-label>x</v-label></v-col>\r\n                    <v-col><v-label>y</v-label></v-col>\r\n                    <v-col><v-label>z</v-label></v-col>\r\n                  </v-row>\r\n                  <v-row class=\"mt-n4\">\r\n                    <v-col cols=\"2\" class=\"text-right mt-1\"\r\n                      ><v-label>In</v-label></v-col\r\n                    >\r\n                    <v-col>\r\n                      <v-text-field\r\n                        dense\r\n                        class=\"ma-0 pa-0\"\r\n                        v-model.number=\"props.in_pos[0]\"\r\n                      >\r\n                      </v-text-field>\r\n                    </v-col>\r\n                    <v-col>\r\n                      <v-text-field\r\n                        dense\r\n                        class=\"ma-0 pa-0\"\r\n                        v-model.number=\"props.in_pos[1]\"\r\n                      >\r\n                      </v-text-field>\r\n                    </v-col>\r\n                    <v-col>\r\n                      <v-text-field\r\n                        dense\r\n                        class=\"ma-0 pa-0\"\r\n                        v-model.number=\"props.in_displace\"\r\n                      >\r\n                      </v-text-field>\r\n                    </v-col>\r\n                  </v-row>\r\n                  <v-row class=\"mt-n8\">\r\n                    <v-col cols=\"2\" class=\"text-right mt-1\"\r\n                      ><v-label>Out</v-label></v-col\r\n                    >\r\n                    <v-col>\r\n                      <v-text-field\r\n                        dense\r\n                        class=\"ma-0 pa-0\"\r\n                        v-model.number=\"props.out_pos[0]\"\r\n                      >\r\n                      </v-text-field>\r\n                    </v-col>\r\n                    <v-col>\r\n                      <v-text-field\r\n                        dense\r\n                        class=\"ma-0 pa-0\"\r\n                        v-model.number=\"props.out_pos[1]\"\r\n                      >\r\n                      </v-text-field>\r\n                    </v-col>\r\n                    <v-col>\r\n                      <v-text-field\r\n                        dense\r\n                        class=\"ma-0 pa-0\"\r\n                        v-model.number=\"props.out_displace\"\r\n                      >\r\n                      </v-text-field>\r\n                    </v-col>\r\n                  </v-row>\r\n                  <v-row class=\"mt-n4\">\r\n                    <v-col>\r\n                      <v-row class=\"mt-n4\">\r\n                        <v-col>\r\n                          <v-select\r\n                            :items=\"shape_types\"\r\n                            label=\"In shape\"\r\n                            dense\r\n                            v-model=\"props.in_shape_type\"\r\n                          ></v-select>\r\n                        </v-col>\r\n                      </v-row>\r\n                      <v-row class=\"mt-n4\">\r\n                        <v-col>\r\n                          <v-text-field\r\n                            dense\r\n                            label=\"width\"\r\n                            class=\"ma-0 pa-0\"\r\n                            v-model.number=\"props.in_size[0]\"\r\n                          >\r\n                          </v-text-field>\r\n                        </v-col>\r\n                        <v-col>\r\n                          <v-text-field\r\n                            dense\r\n                            label=\"height\"\r\n                            class=\"ma-0 pa-0\"\r\n                            v-model.number=\"props.in_size[1]\"\r\n                          >\r\n                          </v-text-field>\r\n                        </v-col>\r\n                      </v-row>\r\n                    </v-col>\r\n                    <v-col>\r\n                      <v-row class=\"mt-n4\">\r\n                        <v-col>\r\n                          <v-select\r\n                            :items=\"shape_types\"\r\n                            label=\"Out shape\"\r\n                            dense\r\n                            v-model=\"props.out_shape_type\"\r\n                          ></v-select> </v-col\r\n                      ></v-row>\r\n                      <v-row class=\"mt-n4\">\r\n                        <v-col>\r\n                          <v-text-field\r\n                            dense\r\n                            label=\"width\"\r\n                            class=\"ma-0 pa-0\"\r\n                            v-model.number=\"props.out_size[0]\"\r\n                          >\r\n                          </v-text-field>\r\n                        </v-col>\r\n                        <v-col>\r\n                          <v-text-field\r\n                            dense\r\n                            label=\"height\"\r\n                            class=\"ma-0 pa-0\"\r\n                            v-model.number=\"props.out_size[1]\"\r\n                          >\r\n                          </v-text-field>\r\n                        </v-col>\r\n                      </v-row>\r\n                    </v-col>\r\n                  </v-row>\r\n                </div>\r\n              </v-card-text>\r\n            </v-card>\r\n          </v-col>\r\n        </v-row>\r\n      </v-container>\r\n    </section>\r\n    <section>\r\n      <v-container>\r\n        <v-card>\r\n          <v-card-title> Customization </v-card-title>\r\n          <v-card-text>\r\n            <v-row>\r\n              <v-col>\r\n                <v-file-input\r\n                  label=\"Background Image\"\r\n                  dense\r\n                  @change=\"update_background_image\"\r\n                ></v-file-input>\r\n              </v-col>\r\n            </v-row>\r\n          </v-card-text>\r\n        </v-card>\r\n      </v-container>\r\n    </section>\r\n    <section>\r\n      <v-container>\r\n        <v-card>\r\n          <v-card-title> Parameters </v-card-title>\r\n          <v-card-text>\r\n            <template v-for=\"prop in Object.keys(props)\">\r\n              <v-row :key=\"prop\" class=\"mt-n4\">\r\n                <v-col cols=\"4\" sm=\"3\" class=\"text-right\">\r\n                  <label :for=\"prop\">{{ prop }}: </label>\r\n                </v-col>\r\n                <v-col>\r\n                  <template v-if=\"isArray(props[prop])\">\r\n                    <span v-for=\"(item, i) in props[prop]\" :key=\"i\">\r\n                      <input\r\n                        :name=\"prop\"\r\n                        type=\"text\"\r\n                        v-model.number=\"props[prop][i]\"\r\n                      />\r\n                    </span>\r\n                  </template>\r\n                  <template v-else>\r\n                    <input\r\n                      :name=\"prop\"\r\n                      type=\"text\"\r\n                      v-model.number=\"props[prop]\"\r\n                    />\r\n                  </template>\r\n                </v-col>\r\n              </v-row>\r\n            </template>\r\n          </v-card-text>\r\n        </v-card>\r\n      </v-container>\r\n    </section>\r\n    <!-- <section>\r\n      <v-container>\r\n        <h3>Computed Value</h3>\r\n        <br />\r\n        <p>Critical Angle: {{ (TIR / Math.PI) * 180 }} degrees</p>\r\n        <p>g2: {{ g2 }}</p>\r\n      </v-container>\r\n    </section> -->\r\n\r\n    <div hidden>\r\n      {{ epe_shape_prop }}\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport KSpace from \"./KSpace.vue\";\r\nimport Layout from \"./Layout.vue\";\r\nimport { single_promise, throttle } from \"./lib/throttle\";\r\nimport { mag } from \"./lib/geo\";\r\nimport { diffraction, k1, trace_EPE } from \"./lib/layout\";\r\nimport { circular, rectangular } from \"./lib/shape\";\r\n\r\nconst g0 = (Math.PI * 2) / 394;\r\n\r\nexport default {\r\n  name: \"HelloWorld\",\r\n  components: {\r\n    KSpace,\r\n    Layout,\r\n  },\r\n  props: {},\r\n  data() {\r\n    return {\r\n      props: {\r\n        // waveguide\r\n        wavelength: 530,\r\n        material: 1.827,\r\n\r\n        // screen\r\n        FOV: 40,\r\n        aspect: [4, 3],\r\n        offset: [0, 0],\r\n\r\n        // kspace\r\n        g1: [g0, 0],\r\n        g3: [0, -g0],\r\n\r\n        // layout\r\n        in_size: [4, 4],\r\n        in_displace: 0,\r\n        in_pos: [-25, -15],\r\n        in_shape_type: \"circle\",\r\n        out_size: [16, 16],\r\n        out_displace: 20,\r\n        out_pos: [5, 15],\r\n        out_shape_type: \"circle\",\r\n      },\r\n      epe_shape: [[0], [0]],\r\n      in_shape2: [[0], [0]],\r\n      out_shape2: [[0], [0]],\r\n      shape_types: [\"circle\", \"rectangle\"],\r\n      background_image: \"\",\r\n    };\r\n  },\r\n  methods: {\r\n    isArray(a) {\r\n      return a instanceof Array;\r\n    },\r\n    grating_period_update(id, value) {\r\n      if (isNaN(value)) value = 0;\r\n\r\n      if (value != 0) {\r\n        let s = (Math.PI * 2) / value / mag(this.props[id]);\r\n        this.props[id][0] *= s;\r\n        this.props[id][1] *= s;\r\n        this.props[id].__ob__.dep.notify();\r\n      }\r\n    },\r\n\r\n    grating_angle_update(id, value) {\r\n      if (isNaN(value)) value = 0;\r\n      let s = mag(this.props[id]);\r\n      this.props[id][0] = Math.cos((value * Math.PI) / 180) * s;\r\n      this.props[id][1] = Math.sin((value * Math.PI) / 180) * s;\r\n      this.props[id].__ob__.dep.notify();\r\n    },\r\n\r\n    update_epe: throttle(\r\n      single_promise(async function () {\r\n        const vm = this;\r\n        const [in_shape2, epe_shape, out_shape2] = await trace_EPE(\r\n          ...arguments\r\n        );\r\n        vm.in_shape2 = in_shape2;\r\n        vm.epe_shape = epe_shape;\r\n        vm.out_shape2 = out_shape2;\r\n        this.report();\r\n        return 0;\r\n      }),\r\n      1\r\n    ),\r\n\r\n    report: throttle(function () {\r\n      window.dataLayer.push({\r\n        event: \"interact\",\r\n        props: this.props,\r\n      });\r\n    }, 10 * 1000),\r\n\r\n    update_background_image(file) {\r\n      if (file) {\r\n        let reader = new FileReader();\r\n        let vm = this;\r\n        reader.onloadend = function () {\r\n          vm.background_image = reader.result;\r\n          console.log(reader.result);\r\n          window.dataLayer.push({\r\n            event: \"interact\",\r\n            filename: file.name,\r\n          });\r\n        };\r\n        reader.readAsDataURL(file);\r\n      }\r\n    },\r\n  },\r\n  computed: {\r\n    // Kspace basics\r\n    k0() {\r\n      return (Math.PI * 2) / this.props.wavelength;\r\n    },\r\n    k1() {\r\n      return k1(\r\n        this.k0,\r\n        (this.props.FOV / 180) * Math.PI,\r\n        ...this.props.offset,\r\n        ...this.props.aspect\r\n      ).arraySync();\r\n    },\r\n\r\n    k2() {\r\n      return diffraction(this.k1, this.props.g1).arraySync();\r\n    },\r\n\r\n    k3() {\r\n      return diffraction(this.k2, this.g2).arraySync();\r\n    },\r\n\r\n    TIR() {\r\n      return Math.asin(1 / this.props.material);\r\n    },\r\n\r\n    // Gratings\r\n    g2() {\r\n      return [\r\n        -this.props.g1[0] - this.props.g3[0],\r\n        -this.props.g1[1] - this.props.g3[1],\r\n      ];\r\n    },\r\n\r\n    g1_period: {\r\n      get() {\r\n        return (Math.PI * 2) / mag(this.props.g1);\r\n      },\r\n      set() {},\r\n    },\r\n    g1_angle: {\r\n      get() {\r\n        return (Math.atan2(this.props.g1[1], this.props.g1[0]) * 180) / Math.PI;\r\n      },\r\n      set() {},\r\n    },\r\n\r\n    g2_period: {\r\n      get() {\r\n        return (Math.PI * 2) / mag(this.g2);\r\n      },\r\n      set() {},\r\n    },\r\n    g2_angle: {\r\n      get() {\r\n        return (Math.atan2(this.g2[1], this.g2[0]) * 180) / Math.PI;\r\n      },\r\n      set() {},\r\n    },\r\n\r\n    g3_period: {\r\n      get() {\r\n        return (Math.PI * 2) / mag(this.props.g3);\r\n      },\r\n      set() {},\r\n    },\r\n    g3_angle: {\r\n      get() {\r\n        return (Math.atan2(this.props.g3[1], this.props.g3[0]) * 180) / Math.PI;\r\n      },\r\n      set() {},\r\n    },\r\n\r\n    in_shape1() {\r\n      if (this.props.in_shape_type == \"circle\")\r\n        return circular(0, 0, ...this.props.in_size, 32).arraySync();\r\n      return rectangular(0, 0, ...this.props.in_size, 1).arraySync();\r\n    },\r\n    out_shape1() {\r\n      if (this.props.out_shape_type == \"circle\")\r\n        return circular(0, 0, ...this.props.out_size, 32).arraySync();\r\n      return rectangular(0, 0, ...this.props.out_size, 1).arraySync();\r\n    },\r\n\r\n    epe_shape_prop() {\r\n      this.update_epe(\r\n        this.props.in_pos,\r\n        this.in_shape1,\r\n        this.props.in_displace,\r\n        this.props.out_pos,\r\n        this.out_shape1,\r\n        this.props.out_displace,\r\n        this.k0,\r\n        this.k1,\r\n        this.k2,\r\n        this.k3\r\n      );\r\n      return 0;\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\r\n<style scoped>\r\n</style>\r\n\r\n\r\n      ","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Main.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Main.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Main.vue?vue&type=template&id=3b1a8a10&scoped=true&\"\nimport script from \"./Main.vue?vue&type=script&lang=js&\"\nexport * from \"./Main.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3b1a8a10\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VCard } from 'vuetify/lib/components/VCard';\nimport { VCardText } from 'vuetify/lib/components/VCard';\nimport { VCardTitle } from 'vuetify/lib/components/VCard';\nimport { VCol } from 'vuetify/lib/components/VGrid';\nimport { VContainer } from 'vuetify/lib/components/VGrid';\nimport { VFileInput } from 'vuetify/lib/components/VFileInput';\nimport { VLabel } from 'vuetify/lib/components/VLabel';\nimport { VRow } from 'vuetify/lib/components/VGrid';\nimport { VSelect } from 'vuetify/lib/components/VSelect';\nimport { VSlider } from 'vuetify/lib/components/VSlider';\nimport { VTextField } from 'vuetify/lib/components/VTextField';\ninstallComponents(component, {VCard,VCardText,VCardTitle,VCol,VContainer,VFileInput,VLabel,VRow,VSelect,VSlider,VTextField})\n","<template>\r\n  <div id=\"app\">\r\n    <v-app>\r\n      <header>\r\n        <v-container>\r\n          <v-row>\r\n            <v-col cols=\"12\" md=\"8\">\r\n              <h1>\r\n                Compact design principle for diffractive exit-pupil expander in\r\n                AR near-eye system\r\n              </h1>\r\n              <br />\r\n              <h3>2021 SPIE. AR|VR|MR</h3>\r\n            </v-col>\r\n            <v-spacer> </v-spacer>\r\n            <v-col>\r\n              <h2 class=\"lab-name\">Modern Nanophotonics Lab</h2>\r\n            </v-col>\r\n          </v-row>\r\n        </v-container>\r\n      </header>\r\n\r\n      <section>\r\n        <v-container>\r\n          <v-card>\r\n            <v-card-title>Interactive Application</v-card-title>\r\n            <v-card-text>\r\n              <div class=\"names\">\r\n                <span>Po-Han Chiu<sup>*a</sup></span>\r\n                <span>Ting-Wei Huang<sup>a</sup></span>\r\n                <span>Yun-Shou Hsu<sup>a</sup></span>\r\n                <span>Bo-Kai Zhang<sup>a</sup></span>\r\n                <span>Szu-Ta Chien<sup>a</sup></span>\r\n                <span>Wen-Chang Hung<sup>b</sup></span>\r\n                <span>Chien-Yi Huang<sup>b</sup></span>\r\n                <span>Yu-Chieh Cheng<sup>a</sup></span>\r\n              </div>\r\n              <div>\r\n                <p>\r\n                  <sup>a</sup>National Taipei University of Technology, No. 1,\r\n                  Section 3, Zhongxiao East Road, Da'an Dist., Taipei, 10608,\r\n                  Taiwan<br />\r\n                  <sup>b</sup>ASUSTeK COMPUTER INC, No. 115, Li-De Rd., Beitou\r\n                  Dist., Taipei 112019, Taiwan\r\n                </p>\r\n              </div>\r\n            </v-card-text>\r\n            <v-divider class=\"mx-4\"> </v-divider>\r\n            <v-card-text>\r\n              <h3>Abstract</h3>\r\n              <p>\r\n                For a diffractive-waveguide-based augmented reality display, we\r\n                demonstrate a rapid and straightforward method to define the\r\n                most compact layout of an exit pupil expander (EPE) from an\r\n                analysis of diffractive optical elements in k-space. The idea is\r\n                to consider all k-vectors coming from in-coupling to\r\n                out-coupling areas according to the grating theory, tracing out\r\n                the EPE grating region, and with a geometrical modeling of this\r\n                problem to find the optimal layout. For a working wavelength of\r\n                532 nm, 40 degrees field of view display, the solution to pack\r\n                the entire layout into a enclosed circle radius and minimum area\r\n                of EPE is presented. Furthermore, a web-based interactive\r\n                application demonstrating the EPE layout calculation is provided\r\n                as a layout design tool.\r\n              </p>\r\n              <p>\r\n                <strong>Keywords:</strong> Near-eye display, Waveguide,\r\n                Augmented Reality, Exit-Pupil Expander, Diffractive Optical\r\n                Elements.\r\n              </p>\r\n            </v-card-text>\r\n          </v-card>\r\n        </v-container>\r\n      </section>\r\n\r\n      <Main />\r\n\r\n      <footer>\r\n        <v-container>\r\n          <v-row>\r\n            <v-col>\r\n              <p>\r\n                Web Designer/Developer: Hans Chiu (Po-Han Chiu)\r\n                <br />\r\n                Email: t110658013@ntut.org.tw\r\n              </p>\r\n              <p>Developed with: Vue, Vuetify, Fabric, TensorFlow</p>\r\n            </v-col>\r\n            <v-col>\r\n              <p>\r\n                This project is aimed to give readers a interactive way to\r\n                understand the principle behind waveguide based AR glasses.\r\n              </p>\r\n\r\n              <p>Â© 2021 TaipeiTech</p>\r\n            </v-col>\r\n          </v-row>\r\n        </v-container>\r\n      </footer>\r\n    </v-app>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Main from \"./components/Main.vue\";\r\n\r\nexport default {\r\n  name: \"App\",\r\n  components: {\r\n    Main,\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" >\r\n#app {\r\n  font-family: Arial, sans-serif;\r\n  background-color: #e3f2fd;\r\n}\r\nheader {\r\n  padding-top: 30px;\r\n  margin-bottom: 10px;\r\n  background-color: white;\r\n}\r\nfooter {\r\n  margin-top: 30px;\r\n  padding: 30px 0;\r\n  background-color: #0069c0;\r\n  color: white;\r\n}\r\n.lab-name {\r\n  text-align: right;\r\n  padding-top: 20px;\r\n  line-height: 100%;\r\n}\r\n.names {\r\n  margin: 0 -10px;\r\n  span {\r\n    margin: 0 10px;\r\n    display: inline-block;\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--1-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--1-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=45b82ec7&\"\nimport script from \"./App.vue?vue&type=script&lang=js&\"\nexport * from \"./App.vue?vue&type=script&lang=js&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VApp } from 'vuetify/lib/components/VApp';\nimport { VCard } from 'vuetify/lib/components/VCard';\nimport { VCardText } from 'vuetify/lib/components/VCard';\nimport { VCardTitle } from 'vuetify/lib/components/VCard';\nimport { VCol } from 'vuetify/lib/components/VGrid';\nimport { VContainer } from 'vuetify/lib/components/VGrid';\nimport { VDivider } from 'vuetify/lib/components/VDivider';\nimport { VRow } from 'vuetify/lib/components/VGrid';\nimport { VSpacer } from 'vuetify/lib/components/VGrid';\ninstallComponents(component, {VApp,VCard,VCardText,VCardTitle,VCol,VContainer,VDivider,VRow,VSpacer})\n","import Vue from 'vue';\r\nimport Vuetify from 'vuetify';\r\nimport 'vuetify/dist/vuetify.min.css'\r\n\r\nVue.use(Vuetify);\r\n\r\nexport default new Vuetify({\r\n});\r\n","\r\nimport Vue from 'vue'\r\nimport App from './App.vue'\r\nimport vuetify from './plugins/vuetify'\r\nimport \"./style/index.scss\"\r\n\r\n\r\nVue.config.productionTip = false\r\n\r\n\r\n\r\nnew Vue({\r\n  vuetify,\r\n  render: h => h(App)\r\n}).$mount('#app')\r\n","export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--1-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=scss&\""],"sourceRoot":""}